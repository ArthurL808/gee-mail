<html>
	<head>
		<div class="mailBox">
			<img src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTWRyJWBEcsIsk4nxxZILoIghsApAMJj1IxcKnOdli6TJgnjFok' alt="mailbox">
				<h1>Geemail</h1>
			</div>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
        //For every geemail messagae create a new row within the tbody
				var tbody = document.querySelector('tbody') 
				
				for (var i = 0; i < window.geemails.length; i++) {
					let message = window.geemails[i]; 
				
					// var newRow = `<tr>
					// 	<td>{message.date}</td>
					// 	<td>{message.sender}</td>
					// 	<td>{message.subject}</td>
					// </tr>`
					
					var newRow = document.createElement('tr')
					var dateEle = document.createElement('td')
					var sendEle = document.createElement('td')
					var subEle = document.createElement('td')

					dateEle.innerText = message.date
					sendEle.innerText = message.sender
					subEle.innerText = message.subject 

					newRow.appendChild(dateEle)
					newRow.appendChild(sendEle)
					newRow.appendChild(subEle)
					
						var newMessage = [message.sender,message.subject,message.date,message.body]
				
				// created table row for message body
				var messageRow = document.createElement('tr');
				var messageEle = document.createElement('td');
				messageEle.innerText = newMessage;
				messageRow.appendChild(messageEle);
				messageRow.style.display = 'none';

				var addClickHandler = function(parentRow, childRow) {
					parentRow.onclick = function(){
						// console.log(childRow.style.display)
						if (childRow.style.display === 'none') {
							childRow.style.display = 'block';
						} else {
						childRow.style.display = 'none';
						}
						
					}
				}

				addClickHandler(newRow, messageRow)
				
				/* newRow.onclick = function (){
					
					console.log(messageRow);

					messageRow.style.display = 'inline-block'
					
				} */
									
					tbody.appendChild(newRow)
					tbody.appendChild(messageRow)
					
				}

				var count = 10;
				document.getElementById("counter").innerText = 'Inbox: ' + count;
				setInterval(function(){
					// console.log(getNewMessage);
					var addedMessage = getNewMessage();
					
					var addedRow = document.createElement('tr')
					var newDate = document.createElement('td')
					var newSub = document.createElement('td')
					var newSend = document.createElement('td')
					
					newDate.innerText = addedMessage.date
					newSub.innerText = addedMessage.subject
					newSend.innerText = addedMessage.sender

					addedRow.appendChild(newDate);
					addedRow.appendChild(newSub);
					addedRow.appendChild(newSend)
					tbody.appendChild(addedRow)
					
					count++;
					document.getElementById("counter").innerText = 'Inbox: ' + count;					
				},2500)
				
				var composeMessage = document.getElementById('compose');
				composeMessage.style.display = 'none';

				function composeMessage(event) {
					var compose = document.getElementById('compose')
				if (compose.style.display === 'none') {
					compose.style.display = 'block'
				} else {
					compose.style.display = 'none'
				}
				
				}

		
			
				
      };
			function openMessage() {
					console.log('opening')
					document.getElementById('compose').style.display = 'block';
				}
    </script>
	</head>
	<body>
		<div class="container" id="main">
			<button onclick="openMessage()">Compose Message</button>
			<div id="outgoing">
				<textarea name="compose" id="compose" cols="50" rows="10"></textarea>
			</div>
			<table border="1">
				<h2 id="counter">
				</h2>
				<tr>
					<th><h3>Date</h3></th>
					<th><h3>Sender</h3></th>
					<th><h3>Subject</h3></th>
				</tr>
				
				<tbody>
				</tbody>

			</table>
		</div>
	</body>
</html>